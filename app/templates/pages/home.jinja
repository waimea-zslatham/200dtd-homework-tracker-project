{#=====================================================
  Home page
  - Hero style greeting banner
  - List of things passed in as 'things' array
  - Form for adding a new thing
=====================================================#}

{% extends 'pages/base.jinja' %}


{% block title %}

    Homework Tracker

{% endblock %}


{% block content %}

    <h1>Homework Tracker</h1>

  
    <article>

            <ul class="subject-list">
                {% for subject in subjects %}
            <li>
                <span class="priority">{{ subject.priority }}</span>
                <a href="/subject/{{ subject.id }}">
                {{ subject.name }} - {{ subject.teacher }}
                </a>

                <a href="/delete/{{ subject.id }}" 
                class="delete-button"
                style="color:red;"
                onclick="return confirm('Are you sure you want to delete {{ subject.name }}?');">
                ðŸ—‘
                </a>

                <h4>Overall Progress</h4>
                    <div id="progress-container">
                        <div id="progress-bar"></div>
                    </div>
                <p id="progress-text">0% Complete</p>
            </li>
            {% else %}
            <p>None!</p>
            {% endfor %}
        </ul>

    </article>

 <article>

        <details>
            <summary>
                +    
            </summary>
            
        <h3>Add a New Subject</h3>

        <form action="/add/subject" method="POST">

            <input
                type="text"
                name="subject"
                placeholder="Name of Subject"
                required
            >

            <input
                type="number"
                name="priority"
                min="0"
                max="5"
                placeholder="Priority of Subject"
                required
            >

             <input
                type="text"
                name="teacher"
                placeholder="Teacher of Subject"
                required
            >

            <button>Add the Subject</button>
             </form>


        </form>

    </article>

  <script>
document.addEventListener("DOMContentLoaded", () => {
  const stored = JSON.parse(localStorage.getItem("homeworkProgress")) || {};
  let total = 0, completed = 0;

  // Count total & completed across all subjects
  for (const subject in stored) {
    for (const task in stored[subject]) {
      total++;
      if (stored[subject][task]) completed++;
    }
  }

  const percent = total === 0 ? 0 : Math.round((completed / total) * 100);

  const bar = document.getElementById("progress-bar");
  const text = document.getElementById("progress-text");

  bar.style.width = percent + "%";
  text.textContent = `${percent}% Complete`;
});
</script>


{% endblock %}

